<script defer src="/js/profile.client.js"></script>
{{#if executor}}
  <main class="profile-main">
    <nav class="profile-nav">
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Информация</button>
        <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-orders" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Заказы в работе</button>
        <button class="nav-link" id="nav-completed-orders-tab" data-bs-toggle="tab" data-bs-target="#nav-completed-orders" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Выполненные заказы</button>
        <button class="nav-link" data-id="nav-portfolio" id="nav-portfolio-tab" data-bs-toggle="tab" data-bs-target="#nav-portfolio" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Портфолио</button>
        <button class="nav-link" data-id="nav-dashboard" id="nav-dashboard-tab" data-bs-toggle="tab" data-bs-target="#nav-dashboard" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Статистика</button>
      </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
        <div class="container profile-container">
          <div class="avatar-container">
            {{#if executor.avatar}}
            <img id="userAvatar" src="/img/avatar/{{executor.avatar}}" alt="avatar" class="img-thumbnail avatar">
            <div class="middle">
              <button id="avatar-edit-button" class="text btn btn-primary">Сменить аватар</button>
            </div>
            {{else}}
            <img id="userAvatar" src="/img/avatar/default.png" alt="avatar" class="img-thumbnail avatar">
            <div class="middle">
              <button id="avatar-edit-button" class="text btn btn-primary">Сменить аватар</button>
            </div>
            {{/if}}
          </div>
          {{!-- {{#if user}} --}}
          <div>
            <p class="h2">{{this.name}} {{this.lastName}}</p>
            <p class="lead">@{{this.username}}</p>
            <p>E-mail: {{this.email}}</p>
            <p>Телефон: {{this.phone}}</p>
            <span>Мои категории:</span>
            <p> 
              {{#each executor.categories}}
              <a href="/categories/{{this._id}}">{{this.title}}</a>  
              {{/each}}
            </p>
          </div>
          <div>
            <p>О себе:</p>
            <article>{{this.about}}</article>
          </div>
          {{!-- {{/if}} --}}
        </div>
      </div>
      <div class="tab-pane fade" id="nav-orders" role="tabpanel" aria-labelledby="nav-profile-tab">
        <div class="container profile-container success">
          <div class="created">
            <div class="profile-header">
              <h1>Мои заказы</h1>
            </div>
            <p class="lead">Гномы-строители еще не завершили эту локацию, но вы всегда можете зайти попозже :)</p>
            {{#each this.orders}}
              <h3>{{this.title}}</h3>
              <p class="lead">{{this.category}}</p>
              <article>{{this.description}}</article>
              <p>{{this.article}}</p>
              <p>{{this.deadline}}</p>
            {{/each}}
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-completed-orders" role="tabpanel" aria-labelledby="nav-plans-tab">
        <div class="container profile-container success">
          <div class="created">
            <div class="profile-header">
              <h1>Выполненные заказы</h1>
            </div>
            <p class="lead">Гномы-строители еще не завершили эту локацию, но вы всегда можете зайти попозже :)</p>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-portfolio" role="tabpanel" aria-labelledby="nav-create-tab">
        <div class="profile-header">
          <h1>Портфолио</h1>
        </div>
        <form action="" method="POST">
          <div class="mb-3">
            <label for="formFileMultiple" class="form-label">Загрузить примеры работ</label>
            <input name="myWorks" class="form-control" type="file" id="formFileMultiple" multiple>
          </div>
          <button class="btn btn-primary" type="submit">Загрузить</button>
        </form>
      </div>
      <div class="tab-pane fade" id="nav-dashboard" role="tabpanel" aria-labelledby="nav-dashboard-tab">
        <div class="profile-header">
          <h1>Статистика</h1>
        </div>
      </div>
    </div>
  </main>
{{else}}
  <main class="profile-main">
    <nav class="profile-nav">
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Информация</button>
        <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-orders" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Заказы</button>
        <button class="nav-link" data-id="nav-dashboard" id="nav-dashboard-tab" data-bs-toggle="tab" data-bs-target="#nav-dashboard" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Статистика</button>
      </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
        <div class="container profile-container">
          <img src="" alt="" class="img-thumbnail">
          {{!-- {{#if user}} --}}
          <div>
            <p class="h2">Имя{{user.firstName}} Фамилия{{user.lastName}}</p>
            <p class="lead">@Никнейм{{user.username}}</p>
            <p>E-mail: {{user.email}}</p>
            <p>Телефон: {{user.phone}}</p>
          </div>
          {{!-- {{/if}} --}}
        </div>
      </div>
      <div class="tab-pane fade" id="nav-orders" role="tabpanel" aria-labelledby="nav-profile-tab">
        <div class="container profile-container success">
          <div class="created">
            <div class="profile-header">
              <h1>Мои заказы</h1>
            </div>
            <p class="lead">Гномы-строители еще не завершили эту локацию, но вы всегда можете зайти попозже :)</p>
            {{#each user.orders}}
              <h3>{{this.title}}</h3>
              <p class="lead">{{this.category}}</p>
              <article>{{this.description}}</article>
              <p>{{this.article}}</p>
              <p>{{this.deadline}}</p>
            {{/each}}
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-dashboard" role="tabpanel" aria-labelledby="nav-dashboard-tab">
        <div class="profile-header">
          <h1>Статистика</h1>
        </div>
      </div>
    </div>
  </main>
{{/if}}

{{!-- Modal window for avatar editing --}}
<div class="modal fade" id="avatarModal" tabindex="-1" aria-labelledby="avatarModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="avatarModalLabel">Загрузите новый аватар</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form action="" method="post">
        <div class="modal-body">
            <div class="mb-3">
              {{!-- <label for="avatarFile" class="form-label">Default file input example</label> --}}
              <input class="form-control" type="file" id="avatarFile" name="avatarFile" required>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
          <button id="avatar-upload" type="button" data-id="avatar-upload" class="btn btn-primary">Загрузить</button>
          <button id="btn-hidden" class="btn btn-primary" type="button" hidden disabled>
            <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
            Loading...
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
